version: "3.8"

services:
  # ================================
  # 🔌 API PRINCIPAL
  # ================================
  api:
    build: .                          # Constrói a imagem a partir do Dockerfile atual
    ports:
      - "3000:3000"                   # Porta externa:interna
    env_file:
      - .env                          # Carrega variáveis de ambiente do arquivo .env
    depends_on:
      - mongodb                       # Aguarda o MongoDB subir primeiro
    restart: always                   # Reinicia automaticamente em caso de falha
    volumes:
      - ./sessions:/app/sessions      # Persistência de sessões da API

  # ================================
  # 🗃️ MONGODB
  # ================================
  mongodb:
    image: mongo:latest               # Imagem oficial do MongoDB
    container_name: mongodb
    ports:
      - "27017:27017"                 # Porta padrão do MongoDB
    volumes:
      - ./mongo-data:/data/db        # Persistência dos dados no host
    restart: always                   # Reinicia automaticamente
